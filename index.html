<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>TimeRaven ‚Äì Interactive Demo</title>

<style>
:root{
 --blue:#273c75;--green:#44bd32;--red:#e84118;--grey:#7f8fa6;
 --ok:#e9f9e9;--warn:#ffe6e6;--bg:#f4f7fa;--shadow:rgba(0,0,0,.12)
}
*{box-sizing:border-box;font-family:-apple-system,Arial,Helvetica,sans-serif}
body{margin:0;background:var(--bg);color:#333}
header{background:var(--blue);color:#fff;padding:18px;font-size:22px;
 display:flex;justify-content:space-between;align-items:center;gap:12px}
button{cursor:pointer;border:none;border-radius:6px}
header button{background:#fff;color:var(--blue);padding:7px 14px;font-size:16px}
main{padding:18px}

/* ---------- LISTS ---------- */
.lists{display:flex;flex-wrap:wrap;gap:18px;margin-bottom:28px}
.panel{background:#fff;flex:1 1 340px;min-width:280px;
       border-radius:8px;box-shadow:0 2px 4px var(--shadow);padding:14px}
.panel h2{margin:0 0 10px;font-size:18px;color:var(--blue)}
ul{list-style:none;margin:0;padding:0}
.item{border-bottom:1px solid #ececec;padding:10px 0;font-size:14px}
.row{display:flex;justify-content:space-between;align-items:center;gap:6px;flex-wrap:wrap}
.tag{background:#dcdde1;border-radius:4px;padding:2px 6px;font-size:12px;margin-left:4px}
.bill{background:#c8f7c5}

/* action-buttons */
.act{padding:4px 8px;font-size:13px;border-radius:4px;color:#fff}
.accept{background:var(--green)}
.reject{background:var(--red)}
.undo{background:var(--grey)}
.edit{background:none;color:var(--blue);font-size:18px;padding:0 4px}
.del{background:none;color:var(--red);font-size:17px;padding:0 4px}

/* ---------- CALENDAR ---------- */
.calendar{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
.day{background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 4px var(--shadow);display:flex;flex-direction:column;min-height:150px}
.dayHeader{font-weight:600;margin-bottom:6px;display:flex;justify-content:space-between}
.dayList{flex:1;font-size:12px}
.dayList li{margin:2px 0}
.tot{font-weight:600;margin-top:4px}
.ok{background:var(--ok)}
.warn{background:var(--warn)}

/* ---------- MODAL ---------- */
#overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;place-items:center;z-index:999}
#modal{background:#fff;border-radius:10px;padding:22px;width:92%;max-width:480px;box-shadow:0 6px 12px var(--shadow)}
#modal h3{margin:0 0 12px;font-size:20px;color:var(--blue)}
label{display:block;font-size:14px;margin:8px 0 4px}
input[type=text],input[type=date],input[type=time],input[type=number]{
 width:100%;padding:7px;border:1px solid #ccc;border-radius:4px}
.rowBtns{text-align:right;margin-top:14px}
.rowBtns button{padding:8px 16px;margin-left:8px;font-size:15px;border:none;border-radius:4px}
.save{background:var(--green);color:#fff}
@media(max-width:620px){
 .lists{flex-direction:column}
 .act{margin-top:4px}
}
</style>
</head>
<body>

<header>
  ü¶Ö TimeRaven Demo
  <button onclick="openForm()">Ôºã Add entry</button>
</header>

<main>
  <!-- status lists -->
  <div class="lists">
    <div class="panel"><h2>Suggestions</h2><ul id="list-sugg"></ul></div>
    <div class="panel"><h2>Approved</h2>   <ul id="list-appr"></ul></div>
    <div class="panel"><h2>Rejected</h2>   <ul id="list-rej"></ul></div>
  </div>

  <div id="weekSummary" style="font-weight:600;margin-bottom:10px"></div>
  <div class="calendar" id="cal"></div>
</main>

<!-- ---------- MODAL ---------- -->
<div id="overlay">
  <div id="modal">
    <h3 id="formTitle">New entry</h3>
    <label>Date       <input  type="date"  id="fd"></label>
    <label>Start      <input  type="time"  id="fs"></label>
    <label>End        <input  type="time"  id="fe"></label>
    <label>Description<input  type="text"  id="fdesc" placeholder="Meeting / Coding"></label>
    <label>Project    <input  type="text"  id="fproj" placeholder="Client / Internal"></label>
    <label>Hourly ‚Ç¨   <input  type="number"id="frate" value="100"></label>
    <label><input type="checkbox" id="fbill"> Billable</label>
    <div class="rowBtns">
      <button onclick="closeForm()">Cancel</button>
      <button class="save" onclick="save()">Save</button>
    </div>
  </div>
</div>

<script>
/* ======= utils ======= */
const DAY = 864e5, TARGET = 7.5;
const $ = id => document.getElementById(id);
const diffH = (s,e)=>{const [sh,sm]=s.split(':').map(Number),[eh,em]=e.split(':').map(Number);return(eh+em/60)-(sh+sm/60)};
const ‚Ç¨= (h,r,b)=>b?h*r:0;
const monday = d=>{const t=new Date(d),day=t.getDay()||7;return new Date(t-DAY*(day-1))};
const today = ()=> new Date().toISOString().split('T')[0];
const uid = ()=> Date.now()+Math.random().toString(16).slice(2);

/* ======= data ======= */
let sugg=[{id:uid(),date:today(),start:"09:00",end:"10:00",desc:"Kick-off",proj:"Acme",rate:120,bill:true}];
let appr=[], rej=[], editState=null;

/* ======= LIST render ======= */
function lineHTML(e){
 const h=diffH(e.start,e.end), eur=‚Ç¨(h,e.rate,e.bill);
 return `<div class=row>
   <span style="flex:1">${e.start}-${e.end} ‚Ä¢ ${h.toFixed(1)}h ‚Ä¢ ${e.desc}<span class="tag">${e.proj}</span>${e.bill?'<span class="tag bill">‚Ç¨'+eur.toFixed(0)+'</span>':''}</span>
   <span class=row>
     ${btns(e)}
     <button class="edit" title="Edit" onclick="edit('${e.id}')">‚úèÔ∏è</button>
     <button class="del"  title="Delete" onclick="del('${e.id}')">üóë</button>
   </span></div>`;
}
function btns(e){
 const block=e.block; // sugg/appr/rej
 if(block==='s'){return `<button class="accept act" onclick="move('s','a','${e.id}')">Accept</button>
                         <button class="reject act" onclick="move('s','r','${e.id}')">Reject</button>`;}
 if(block==='a'){return `<button class="undo act"   onclick="move('a','s','${e.id}')">Undo</button>
                         <button class="reject act" onclick="move('a','r','${e.id}')">Reject</button>`;}
 if(block==='r'){return `<button class="undo act"   onclick="move('r','s','${e.id}')">Undo</button>
                         <button class="accept act" onclick="move('r','a','${e.id}')">Accept</button>`;}
}

/* tag block property to items for button logic */
function tag(arr,block){return arr.map(o=>({...o,block}))}

function renderLists(){
 $('list-sugg').innerHTML = tag(sugg,'s').map(lineHTML).join('');
 $('list-appr').innerHTML = tag(appr,'a').map(lineHTML).join('');
 $('list-rej' ).innerHTML = tag(rej ,'r').map(lineHTML).join('');
}

/* ======= calendar render ======= */
function renderCal(){
 const cal=$('cal');cal.innerHTML='';
 const weekStart=monday(today());
 let wH=0,w‚Ç¨=0;
 for(let i=0;i<7;i++){
   const dObj=new Date(weekStart.getTime()+DAY*i), ds=dObj.toISOString().split('T')[0];
   const items=[...sugg,...appr].filter(x=>x.date===ds); // only active work
   const h=items.reduce((a,b)=>a+diffH(b.start,b.end),0);
   const eur=items.reduce((a,b)=>a+‚Ç¨(diffH(b.start,b.end),b.rate,b.bill),0);
   wH+=h; w‚Ç¨+=eur;
   const li=items.map(x=>`<li>${x.start}-${x.end} ${x.desc} ${x.bill?'‚Ç¨'+‚Ç¨(diffH(x.start,x.end),x.rate,x.bill).toFixed(0):''}</li>`).join('');
   const day=document.createElement('div');
   day.className='day '+(h>=TARGET?'ok':'warn');
   day.innerHTML=`<div class=dayHeader><span>${dObj.toLocaleDateString('en-GB',{weekday:'short'})}</span><span>${ds}</span></div>
                  <ul class=dayList>${li}</ul>
                  <div class=tot>${h.toFixed(1)}h / ‚Ç¨${eur.toFixed(0)}</div>
                  <div style="font-size:11px;color:${h>=TARGET?'var(--red)':'var(--grey)'}">
                    ${h>=TARGET?'+':'‚àí'}${Math.abs(h-TARGET).toFixed(1)}h
                  </div>`;
   cal.appendChild(day);
 }
 $('weekSummary').textContent=`Week total: ${wH.toFixed(1)}h  ‚Ä¢  ‚Ç¨${w‚Ç¨.toFixed(0)}`;
}

/* ======= CRUD ======= */
function move(from,to,id){
 const src = from==='s'?sugg:from==='a'?appr:rej;
 const dst = to  ==='s'?sugg:to  ==='a'?appr:rej;
 const i=src.findIndex(x=>x.id===id);
 if(i>-1){dst.push(src[i]);src.splice(i,1);update();}
}
function del(id){
 if(confirm('Delete entry?')){
   [sugg,appr,rej].forEach(arr=>{
     const i=arr.findIndex(x=>x.id===id); if(i>-1)arr.splice(i,1);
   });
   update();
 }
}
function edit(id){
   const arr=[sugg,appr,rej].find(a=>a.some(x=>x.id===id));
   const obj=arr.find(x=>x.id===id);
   editState={arr,obj};
   openForm(obj);
}

/* ======= modal form ======= */
const overlay=$('overlay'), formTitle=$('formTitle');
function openForm(o={}){
 editState=null;
 formTitle.textContent=o.id?'Edit entry':'New entry';
 fd.value=o.date||today();fs.value=o.start||'09:00';fe.value=o.end||'17:00';
 fdesc.value=o.desc||'';fproj.value=o.proj||'';frate.value=o.rate||100;fbill.checked=o.bill??true;
 overlay.style.display='grid';
}
function closeForm(){overlay.style.display='none';}

function save(){
 const obj={id:(editState?editState.obj.id:uid()),
           date:fd.value,start:fs.value,end:fe.value,
           desc:fdesc.value||'‚Äî',proj:fproj.value||'‚Äî',
           rate:+frate.value||0,bill:fbill.checked};
 if(editState){
   const idx=editState.arr.findIndex(x=>x.id===editState.obj.id);
   editState.arr[idx]=obj;
 }else{ sugg.push(obj); }
 closeForm(); update();
}

/* ======= helper ======= */
function update(){renderLists();renderCal();}
update();
</script>
</body>
</html>
